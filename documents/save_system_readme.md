# 游戏存档系统说明

## 概述
为你的迷宫探索游戏添加了完整的存档系统，包括暂停菜单存档、快速保存/加载功能，以及完善的错误处理机制。

## 功能特点

### 1. 暂停菜单存档功能
- **位置**: 游戏暂停界面 (按ESC键打开)
- **功能**: 
  - 保存游戏按钮：保存当前游戏进度
  - 加载游戏按钮：加载已保存的游戏进度
  - 状态显示：实时显示保存/加载状态和结果

### 2. 快捷键功能
- **F5**: 快速保存当前游戏状态
- **F6**: 快速加载最近的存档
- **ESC**: 打开/关闭暂停菜单

### 3. 保存的数据内容
- 当前关卡名称
- 玩家血量和最大血量
- 玩家经验值和升级所需经验
- 玩家当前位置
- 保存时间戳
- 游戏版本信息

### 4. 错误处理机制
- 文件访问错误检测
- 数据格式验证
- 关卡文件存在性检查
- 用户友好的错误消息显示

### 5. 通知系统
- 保存成功/失败通知
- 加载成功/失败通知
- 右上角浮动通知显示
- 自动消失的动画效果

## 技术实现

### 核心组件
1. **SaveManager**: 全局存档管理器
2. **NotificationManager**: 通知系统管理器
3. **暂停菜单增强**: 添加存档/读档界面

### 文件结构
```
scripts/
├── SaveManager.gd          # 存档管理器
├── NotificationManager.gd  # 通知管理器
└── GameManager.gd          # 游戏管理器

scenes/
├── pause_menu.gd          # 暂停菜单脚本
└── pause_menu.tscn        # 暂停菜单场景

levels/
└── level_1.gd             # 关卡脚本(添加快捷键支持)
```

### 存档文件位置
- **路径**: `user://save_game.dat`
- **格式**: Godot VAR格式 (二进制)
- **内容**: Dictionary结构的游戏数据

## 使用方法

### 基本操作
1. **保存游戏**: 
   - 按ESC打开暂停菜单
   - 点击"保存游戏"按钮
   - 或者直接按F5快速保存

2. **加载游戏**:
   - 按ESC打开暂停菜单
   - 点击"加载游戏"按钮(需要有存档)
   - 或者直接按F6快速加载

### 高级功能
- **存档信息预览**: 鼠标悬停在"加载游戏"按钮上可查看存档详情
- **自动错误恢复**: 系统会自动处理各种错误情况
- **场景切换支持**: 加载存档时自动切换到保存时的关卡

## 扩展建议

### 未来可以添加的功能
1. **多存档位**: 支持多个存档槽位
2. **存档缩略图**: 保存游戏截图作为存档预览
3. **自动保存**: 定期自动保存游戏进度
4. **云存档**: 支持云端存档同步
5. **存档加密**: 防止存档文件被修改

### 自定义配置
可以在`SaveManager.gd`中修改以下设置：
- `SAVE_PATH`: 存档文件路径
- 保存的数据结构和内容
- 错误处理策略

## 注意事项

1. **性能考虑**: 存档操作在主线程进行，大型游戏可能需要异步处理
2. **数据安全**: 当前版本不包含存档加密，适合单机游戏
3. **兼容性**: 更新游戏时需要考虑存档格式的向后兼容性
4. **存档位置**: 使用Godot的用户数据目录，跨平台兼容

## 故障排除

### 常见问题
1. **保存失败**: 检查磁盘空间和文件权限
2. **加载失败**: 确认存档文件存在且格式正确
3. **按钮无响应**: 检查SaveManager是否正确配置为Autoload
4. **通知不显示**: 确认NotificationManager已添加为全局单例

### 调试技巧
- 查看控制台输出获取详细错误信息
- 检查`user://`目录中的存档文件
- 验证project.godot中的Autoload配置 